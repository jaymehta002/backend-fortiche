import{a as z,r as a,aH as H,a1 as O,j as t,L as D}from"./main-17S3Hvul.js";import{B as i}from"./Button-D9xH6dL9.js";import{I as f}from"./Input-DVQunyol.js";import{R as F}from"./index-sky1eh08.js";/* empty css                   */import{X as J}from"./x-bcItyjpl.js";import{m as C}from"./motion-jzD0fvbA.js";import{C as M,a as Q}from"./chevron-right-CGY7HI01.js";import"./cn-DUyS5Z8L.js";import"./createLucideIcon-DUHjy5LS.js";const te=()=>{const k=z(),[m,R]=a.useState(""),[d,S]=a.useState(""),[n,b]=a.useState(null),[l,p]=a.useState([]),[r,j]=a.useState(""),[o,T]=a.useState([]),[N,c]=a.useState(""),h=a.useRef(null),L=a.useRef(null),[P,{isLoading:v}]=H(),{data:u,isLoading:A}=O(),x=(u==null?void 0:u.data)||[],_=async()=>{if(c(""),!d.trim()){c("Title is required");return}if(!m.trim()){c("Content is required");return}try{const e=new FormData;e.append("title",d.trim()),e.append("content",m.trim()),e.append("tags",JSON.stringify(l)),n&&e.append("thumbnail",n),e.append("products",JSON.stringify(o)),await P(e).unwrap(),k("/recommendations")}catch{c("Failed to create recommendation. Please try again.")}},w=a.useCallback(()=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{const s=e.files[0];s&&b(s)}},[]),q=a.useMemo(()=>({toolbar:{container:[[{header:[2,3,4,!1]}],["bold","italic","underline","blockquote"],[{color:[]}],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]],handlers:{image:w}}}),[w]),B=e=>{T(s=>s.includes(e._id)?s.filter(g=>g!==e._id):[...s,e._id])},y=e=>{h.current&&h.current.scrollBy({left:e==="left"?-300:300,behavior:"smooth"})},E=()=>{r.trim()&&!l.includes(r.trim())&&(p([...l,r.trim()]),j(""))},U=e=>{p(l.filter(s=>s!==e))};return t.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white shadow-md rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx(D,{to:"/recommendations",children:t.jsx(i,{className:"px-6 py-2",children:"← Back"})}),t.jsx(i,{variant:"secondary",onClick:_,className:"px-6 py-2",disabled:v,children:v?"Publishing...":"Publish"})]}),N&&t.jsx("div",{className:"text-red-500 mb-4",children:N}),t.jsx(f,{placeholder:"Title",value:d,onChange:e=>S(e.target.value),className:"w-full my-4 text-2xl font-bold bg-transparent border-none placeholder:text-2xl"}),t.jsx(F,{ref:L,className:"border-none text-lg mb-4",theme:"snow",value:m,modules:q,onChange:R}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Thumbnail"}),t.jsx(f,{type:"file",onChange:e=>b(e.target.files[0]),className:"w-full"}),n&&t.jsx("img",{src:URL.createObjectURL(n),alt:"Thumbnail preview",className:"mt-2 w-32 h-32 object-cover rounded"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:l.map(e=>t.jsxs("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded flex items-center",children:[e,t.jsx("button",{type:"button",onClick:()=>U(e),className:"ml-1 text-blue-600 hover:text-blue-800",children:t.jsx(J,{size:14})})]},e))}),t.jsxs("div",{className:"flex",children:[t.jsx(f,{type:"text",value:r,onChange:e=>j(e.target.value),placeholder:"Add a tag",className:"flex-1 mr-2"}),t.jsx(i,{onClick:E,children:"Add Tag"})]})]}),t.jsxs("div",{className:"relative mt-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Products"}),t.jsxs("div",{className:"relative overflow-hidden",children:[t.jsx(C.div,{ref:h,className:"flex space-x-4  overflow-x-auto pb-4",drag:"x",dragConstraints:{right:0,left:-1e3},children:A?t.jsx("p",{children:"Loading products..."}):x.length===0?t.jsx("p",{children:"No products available"}):x.map(e=>{var s;return t.jsxs(C.div,{className:`flex-shrink-0 w-48 bg-green-light gap-4 h-64 rounded-lg overflow-hidden shadow-md cursor-pointer ${o.includes(e._id)?"ring-4 ring-blue-500":""}`,whileHover:{scale:1.05},onClick:()=>B(e),children:[t.jsx("img",{src:((s=e.imageUrls)==null?void 0:s[0])||"/api/placeholder/200/200",alt:e.name||"productname",className:"w-full h-40 object-cover"}),t.jsxs("div",{className:"p-4",children:[t.jsx("h4",{className:"font-semibold text-sm truncate",children:e.name}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.price,"€"]})]})]},e._id)})}),t.jsx(i,{variant:"ghost",size:"icon",className:"absolute top-1/2 left-2 -translate-y-1/2 bg-white/80 hover:bg-white",onClick:()=>y("left"),children:t.jsx(M,{className:"h-6 w-6"})}),t.jsx(i,{variant:"ghost",size:"icon",className:"absolute top-1/2 right-2 -translate-y-1/2 bg-white/80 hover:bg-white",onClick:()=>y("right"),children:t.jsx(Q,{className:"h-6 w-6"})})]})]}),o.length>0&&t.jsxs("div",{className:"mt-6",children:[t.jsx("h4",{className:"text-lg font-semibold",children:"Selected Products:"}),t.jsx("ul",{className:"list-disc list-inside",children:o.map(e=>{const s=x.find(g=>g._id===e);return t.jsx("li",{className:"mt-2",children:s?s.name:`Product ID: ${e}`},e)})})]})]})};export{te as default};
